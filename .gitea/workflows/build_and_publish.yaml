name: Run unit tests
run-name: ${{ gitea.repository }} PHP unit tests
on:
  push:
    tags:
      - v*.**

jobs:
  build_and_publish:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v2
      - name: Build archive
        run: |
          tar \
            --exclude='./storage/db' \
            --exclude='./storage/ticks' \
            --exclude='./storage/upload' \
            -czpvf tkr.${{ gitea.ref_name }}.tgz \
            config public src storage templates
